<?php                require_once "classes/_Var.php";$Var        =_Var::getInstance();$Var->__autoload("Request","Connection","Cursor","Text","Data");       class ClaimComplaint{      private $request,              $connection,              $cursor,              $sql,              $text,              $_var,			  $data;      private static  $instance;      	  private function __construct(){	                   $this->request    = Request::getInstance();	                   $this->connection = Connection::getInstance();	                   $this->cursor     = Cursor::getInstance();	                   $this->sql        = Sql::getInstance();	                   $this->text       = Text::getInstance();	                   $this->_var       = _Var::getInstance();					   $this->data       = Data::getInstance();					   $this->connection->connect();					   $this->request->setVar("TYPE" ,"type");					   $this->request->setVar("COMPANY","Compania");					   $this->request->setVar("USER","Usuario");					   $this->request->setVar("SELECTED","selected");					   $this->request->setVar("CODE","code");					   $this->request->setVar("IDENTITY","identity");					   $this->request->setVar("COLLABORATOR","Colaborador");					   $this->request->setVar("NO_ACT","NoAct");					   $this->request->setVar("APROVED_REJECTED" ,"ApruebaRechaza");					   $this->request->setVar("COORDINATOR" ,"Coordinador");					   $this->request->setVar("CAUSE_REJECTION","MotivoRechazo");					   $this->request->setVar("ARGUMENT" ,"Argumentacion");                       $this->request->setVar("OPENING_DATE","FechaApertura");					   $this->request->setVar("HOURS","Horas");					   $this->request->setVar("MINUTES","Minutos");					   $this->request->setVar("OPEN_MAILBOX","AbrioBuzon");              		   $this->request->setVar("CLAIMS","No_claim");					   $this->request->setVar("GREETINGS","No_greeting");					   $this->request->setVar("SUGGESTIONS","No_suggestion");					   	                   $this->request->setVar("OPTION","option");                       $this->request->setVar("OPENING_DATE","FechaApertura");					   $this->request->setVar("HOURS","Horas");					   $this->request->setVar("MINUTES","Minutos");					   $this->request->setVar("OPEN_MAILBOX","AbrioBuzon");              		   $this->request->setVar("TYPE","type");					   $this->request->setVar("CLAIM_DATE","FechaQueja");					   $this->request->setVar("WHO_MAKE_REQ","QuienSQR");					   $this->request->setVar("ADDRESS","Direccion");					   $this->request->setVar("PHONE","Telefono");					   $this->request->setVar("EMAIL","Email");					   $this->request->setVar("FAMILY_OR_TH","Familiar");					   $this->request->setVar("CLASSIFICATION","Clasificacion");					   $this->request->setVar("OTHER","Otros");					   $this->request->setVar("COMMUNICATION_CHANNEL","CanalComunicacion");					   $this->request->setVar("PROCESS","Proceso");					   $this->request->setVar("SUBJECT","AsuntoQR");					   $this->request->setVar("REGISTER","RegistroQR");					   $this->request->setVar("COLLAB","collab");					   $this->request->setVar("ACTIVITY","Actividad");					   $this->request->setVar("COMPLIANCE_DATE","FechaCumplimiento");					   $this->request->setVar("RESPONSIBLE","Responsable");					   $this->request->setVar("APPLICATION","application"); 					   $this->request->setVar("CODE_ACT","codeAct"); 					   $this->request->setVar("IDENTITY_ACT","identityAct");                     switch($this->request->getVar("OPTION")):                             //OPEN_MAILBOX*************************************************							case "saveInitialization":$this->saveInitialization();break;						    //*************************************************************							//ADDRESSING*****************************************							case "initialization":$this->initialization();break;							case "openingAct":$this->openingAct();break;	 						    case "openMailBox":$this->openMailBox();break;		 							case "addressing":$this->addressing();break;						    case "addressingBring":$this->addressingBring();break;						    case "approvedRejected":$this->approvedRejected();break;						    case "deleteCollab":$this->deleteCollab();break;						    case "deleteActivity":$this->deleteActivity();break;						    case "savePartner":$this->savePartner();break;	                             case "saveActivity":$this->saveActivity();break;	 			                            case "saveSolution":$this->saveSolution();break;	 											 							case "saveAddressing":$this->saveAddressing();break;						    case "saveArgument":$this->saveArgument();break;							//REGISTER_REQUESTS*************************************************		 							case "saveOpenMailbox":$this->saveOpenMailbox();break;						    //******************************************************                     endswitch;						$this->connection->close();						   }//End __construct      public  function __destruct(){                       $this->request;                       $this->connection;                       $this->cursor;                       $this->sql;                       $this->text;                       $this->_var;					   $this->data;					             $instance;                       }//End __destruct		      public  static  function getInstance(){                               if(!(self::$instance instanceof self))                                  self::$instance = new self();                               return self::$instance;                                 }//End getInstance             private function initialization(){					  $this->text->setBuffer('<link rel="stylesheet" type="text/css" href="css/blitzer/jquery.fancybox-1.2.6.css" media="screen" />											  <script type="text/javascript" src="js/jquery.fancybox-1.2.6.pack.js"></script>');					  $this->cursor->consultExecute($this->sql->setSentence("30004"));				while($this->cursor->next($this->cursor->get()))					  $this->_var->VTypeQR[$this->cursor->getParameter("codigo")]=array($this->cursor->getParameter("codigo"),$this->cursor->getParameter("tipo"));					$this->cursor->consultExecute($this->sql->setSentence("30019",$this->request->getVar("COMPANY")));				$this->cursor->next($this->cursor->get());				if($this->cursor->getParameter("numacta")){				$this->text->setBuffer('<script>Data.table("exampleInitializationData");</script><div class="display ui-state-default"><table class="display ui-state-default ui-corner-all" id="exampleInitializationData">								<thead>									<tr>										<th>#</th>										<th>No. Acta</th>										<th>Fecha Apertura</th>										<th>Hora</th>																				<th>Fecha Registro</th>										<th>No. Quejas y/o Reclamos</th>										<th>No. Felicitaciones</th>										<th>No. Sugerencias</th>										<th>Abri&oacute;</th>										<th>Registr&oacute;</th>									</tr>								</thead>								<tbody>');					   $this->cursor->consultExecute($this->sql->setSentence("30020",$this->request->getVar("COMPANY"),$this->cursor->getParameter("numacta")));                       while($this->cursor->next($this->cursor->get())){							$this->_var->VMailBox[$this->cursor->getParameter("numacta")]=array($this->cursor->getParameter("numacta"),																				   $this->cursor->getParameter("fechaapertura"),																				   $this->cursor->getParameter("horaapertura"), 																				   $this->cursor->getParameter("fecharegistro"),																				   $this->cursor->getParameter("usuarioabrio"),																				   $this->cursor->getParameter("usuarioregistra"));								$this->_var->VTQR[$this->cursor->getParameter("cod_qrs")]=array($this->cursor->getParameter("cod_qrs"),																		       $this->cursor->getParameter("num_qrs"));							}//End while			           $this->_var->set("ID",1);					   foreach($this->_var->VMailBox as $this->_var->MB){							   $this->text->setBuffer('<tr id="openingAct" style="cursor:pointer;" >												 <td>'.$this->_var->get("ID").'</td>												 <td id="move_'.$this->_var->MB[0].'" style="cursor:pointer;" align="center"><a href="claimComplaint.php?option=openingAct&NoAct='.$this->_var->MB[0].'&Compania='.$this->request->getVar("COMPANY").'" id="claimComplaintRecordView_'.$this->_var->MB[0].'">'.$this->_var->MB[0].'</a><script>Text.highLight("move_'.$this->_var->MB[0].'");Utility.fancyBox("claimComplaintRecordView_'.$this->_var->MB[0].'",true);</script></td>												 <td>'.$this->_var->MB[1].'</td>												 <td>'.$this->_var->MB[2].'</td>												 <td>'.$this->_var->MB[3].'</td>');                               foreach($this->_var->VTypeQR as $this->_var->CodTQR){			                           $this->_var->VTQR[$this->_var->CodTQR[0]]>0?$this->text->setBuffer('<td align="center">'.$this->_var->VTQR[$this->_var->CodTQR[0]][1].'</td>'):$this->text->setBuffer('<td align="center">0</td>');;					   $this->_var->increment("ID",1);					   }//End foreach							   $this->text->setBuffer('<td>'.$this->_var->MB[4].'</td>												 <td>'.$this->_var->MB[5].'</td>												 </tr>');					   }//End foreach					   $this->cursor->freeResult();				$this->text->setBuffer('</tbody></table></div>');					   }//End if					   }//End initialization method            private function openingAct(){				$this->text->setBuffer('<div id="print" '.$this->data->getParameter("GUI_BUTTOM_CENTER").'>				                        <span '.$this->data->getParameter("GUI_BUTTOM").' class="ui-corner-all  ui-state-default" id="sendPrint">&nbsp;<img style="scroll: 10px center; cursor:pointer;" src="Imgs/b_print.png" title="Imprimir" alt="Imprimir" onClick="Utility.loading();setTimeout(function() {Text.print(\'print\',\'sendPrint\');Utility.close();}, Data.DFT_TM);"/>&nbsp;</span>										<table align="center" style="font-size:15pt">													    <tr><td><img id="log" src="../Imgs/Logo.jpg" width="88" height="78"></td>													    <td>');		        $this->cursor->consultExecute($this->sql->setSentence("30053",$this->request->getVar("COMPANY"))); 		        while($this->cursor->next($this->cursor->get()))		              $this->text->setBuffer('<table><tr><td align="center"><b>'.$this->text->capitalized($this->cursor->getParameter("nombre")).'</b>											             <br>'.$this->cursor->getParameter("nit").'											             <br>'.$this->cursor->getParameter("direccion").'											             <br>'.$this->cursor->getParameter("telefonos").'											  </td></tr></table></td></tr></table><br>');										 			    $this->cursor->consultExecute($this->sql->setSentence("30051",$this->request->getVar("COMPANY"),$this->request->getVar("COMPANY"),$this->request->getVar("NO_ACT")));                $this->cursor->next($this->cursor->get());	            $this->text->setBuffer('<table width="1100pt" style="font-size:15pt"><tr><td><div align="center"><br><b>APERTURA BUZON QUEJAS Y RECLAMOS</b><br><br><b>ACTA DE APERTURA N&Uacute;MERO '.$this->cursor->getParameter("numacta").'</b> <b><br>Fecha:</b> '.$this->text->replace($this->cursor->getParameter("fecharegistro")," ","<br><b>Hora:</b> ").'<br></div>                              <tr><td id="recordCC"></div><br><br>'.$this->text->replace($this->cursor->getParameter("actaapertura"),"  ","<br><br><br><br><b>").'</td></tr></table></div><script>Text.justify("recordCC");Text.opacity("log");</script>');					   $this->cursor->freeResult();					   }//End openingAct method				   					   	  private function openMailBox(){						   $this->cursor->consultExecute($this->sql->setSentence("30004"));				while($this->cursor->next($this->cursor->get()))					  $this->_var->VTypeQR[$this->cursor->getParameter("codigo")]=array($this->cursor->getParameter("codigo"),$this->cursor->getParameter("tipo"));					$this->cursor->consultExecute($this->sql->setSentence("30019",$this->request->getVar("COMPANY")));				$this->cursor->next($this->cursor->get());				if($this->cursor->getParameter("numacta")){				$this->text->setBuffer('<table cellpadding="0" cellspacing="0" class="display ui-corner-all  ui-state-default">								<thead>									<tr>										<th>#</th>										<th>No. Acta</th>										<th>Fecha Apertura</th>										<th>Hora</th>																				<th>Fecha Registro</th>										<th>No. Quejas y/o Reclamos</th>										<th>No. Felicitaciones</th>										<th>No. Sugerencias</th>										<th>Abri&oacute;</th>										<th>Registr&oacute;</th>									</tr>								</thead>								<tbody>');					   $this->cursor->consultExecute($this->sql->setSentence("30020",$this->request->getVar("COMPANY"),$this->cursor->getParameter("numacta")));                       while($this->cursor->next($this->cursor->get())){							$this->_var->VMailBox[$this->cursor->getParameter("numacta")]=array($this->cursor->getParameter("numacta"),																				   $this->cursor->getParameter("fechaapertura"),																				   $this->cursor->getParameter("horaapertura"), 																				   $this->cursor->getParameter("fecharegistro"),																				   $this->cursor->getParameter("usuarioabrio"),																				   $this->cursor->getParameter("usuarioregistra"));								$this->_var->VTQR[$this->cursor->getParameter("cod_qrs")]=array($this->cursor->getParameter("cod_qrs"),																		       $this->cursor->getParameter("num_qrs"));							}//End while			           $this->_var->set("ID",1);					   foreach($this->_var->VMailBox as $this->_var->MB){							   $this->text->setBuffer('<tr>												 <td>'.$this->_var->get("ID").'</td>												 <td>'.$this->_var->MB[0].'</td>												 <td>'.$this->_var->MB[1].'</td>												 <td>'.$this->_var->MB[2].'</td>												 <td>'.$this->_var->MB[3].'</td>');                               foreach($this->_var->VTypeQR as $this->_var->CodTQR){			                           if($this->_var->VTQR[$this->_var->CodTQR[0]])										  $this->text->setBuffer('<td align="center">'.$this->_var->VTQR[$this->_var->CodTQR[0]][1].'</td>');					   $this->_var->increment("ID",1);					   }//End foreach							   $this->text->setBuffer('<td>'.$this->_var->MB[4].'</td>												 <td>'.$this->_var->MB[5].'</td>												 </tr>');					   }//End foreach					   $this->cursor->freeResult();				$this->text->setBuffer('</tbody></table>');					   }//End if					   }//End openMailBox method					   					   	  //ADDRESSING*****************************************************************************************************		  	  private function addressing(){	                      $this->text->setBuffer('<script>Data.table("exampleAddArgData");</script><div class="display ui-state-default">');						  $this->request->getVar("SELECTED")=="addressing"?						  $this->text->setBuffer('<table class="display ui-state-default ui-corner-all" id="exampleAddArgData">								<thead>									<tr>										<th>#</th>										<th>No. Buz&oacute;n</th>										<th>Solicitud</th>										<th>Fecha Solicitud</th>										<th>Fecha Registro</th>										<th>Solicita</th>										<th>Asunto</th>										<th>Estado</th>									</tr>								</thead>								<tbody>'):						  $this->text->setBuffer('<table class="display ui-state-default ui-corner-all" id="exampleAddArgData">								<thead>									<tr>										<th>#</th>										<th>No. Buz&oacute;n</th>										<th>Solicitud</th>										<th>Fecha Solicitud</th>										<th>Solicita</th>										<th>Asunto</th>										<th>Fecha Aprobaci&oacute;n</th>										<th>Estado</th>									</tr>								</thead>								<tbody>');; 					      if($this->request->getVar("SELECTED")=="addressing"){						     $this->cursor->consultExecute($this->sql->setSentence("30024",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE")));						     //start(A)							 $this->_var->set("ID",1);							 while($this->cursor->next($this->cursor->get())):								$this->text->setBuffer('<tr align="center" style="cursor:pointer;" onClick="ClaimComplaint.addressingBring(\''.$this->request->getVar("COMPANY").'\',\''.$this->request->getVar("TYPE").'\',\''.$this->cursor->getParameter("autoid").'\',\'addressing\')">													    <td>'.$this->_var->get("ID").'</td>														<td>'.$this->cursor->getParameter("numacta").'</td>													    <td>'.$this->cursor->getParameter("autoid").'</td>													    <td>'.$this->cursor->getParameter("fechasolicitud").'</td>														<td>'.$this->cursor->getParameter("fecharegistro").'</td>														<td>'.$this->cursor->getParameter("solicita").'</td>														<td>'.$this->cursor->getParameter("asunto").'</td>														<td>'.$this->cursor->getParameter("estado").'');														$this->cursor->getParameter("estado")=="Pendiente"?														$this->text->setBuffer(' <img src="/Imgs/b_tblanalyse.png" border="0" title="Aprobar/Rechazar Direccionar" />'):null;;														$this->text->setBuffer('</td>														</tr>');														$this->_var->increment("ID");						        endwhile;							 //end(A)								 }							 else if($this->request->getVar("SELECTED")=="proposed"){							 $this->cursor->consultExecute($this->sql->setSentence("30041",$this->request->getVar("COMPANY"),$this->request->getVar("COMPANY")));							 $this->cursor->next($this->cursor->get());							 $this->request->getVar("TYPE")==1?						     $this->cursor->consultExecute($this->sql->setSentence("30042",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE"),$this->cursor->getParameter("usucoordinador"))):null;;						     //start(B)							 $this->_var->set("ID",1);							 while($this->cursor->next($this->cursor->get())):								$this->text->setBuffer('<tr align="center" style="cursor:pointer;" onClick="ClaimComplaint.addressingBring(\''.$this->request->getVar("COMPANY").'\',\''.$this->request->getVar("TYPE").'\',\''.$this->cursor->getParameter("autoid").'\',\'proposed\')">													    <td>'.$this->_var->get("ID").'</td>														<td>'.$this->cursor->getParameter("numacta").'</td>													    <td>'.$this->cursor->getParameter("autoid").'</td>													    <td>'.$this->cursor->getParameter("fechasolicitud").'</td>														<td>'.$this->cursor->getParameter("fecharegistro").'</td>														<td>'.$this->cursor->getParameter("solicita").'</td>														<td>'.$this->cursor->getParameter("asunto").'</td>														<td>'.$this->cursor->getParameter("estado").'');														$this->cursor->getParameter("estado")=="Argumentado"?														$this->text->setBuffer(' <img src="/Imgs/b_tblanalyse.png" border="0" title="Proponer Acciones y/o Actividades" />'):null;;														$this->text->setBuffer('</td>														</tr>');														$this->_var->increment("ID");						        endwhile;							 //end(B)								 }else{							     $this->cursor->consultExecute($this->sql->setSentence("30035",$this->request->getVar("COMPANY")));								 while($this->cursor->next($this->cursor->get()))								       $this->cursor->getParameter("coordinador")==$this->request->getVar("USER")?$this->_var->set("COORDINATOR",true):$this->_var->set("COORDINATOR",false);;                                 								 $this->cursor->consultExecute($this->sql->setSentence("30037",$this->request->getVar("COMPANY"),'1',$this->request->getVar("USER")));							     while($this->cursor->next($this->cursor->get()))									   $this->cursor->getParameter("colaborador")==$this->request->getVar("USER")?$this->_var->set("COLLABORATOR",true):$this->_var->set("COLLABORATOR",false);;									   								 $this->cursor->consultExecute($this->sql->setSentence("30038",$this->request->getVar("COMPANY"),'1','1'));							     $this->cursor->next($this->cursor->get());							     $this->_var->set("CNT_COLLABORATOR",1);								 if($this->cursor->getParameter("cnt_collaborator")>0){								    $this->_var->set("G_COLLA",$this->cursor->getParameter("cnt_collaborator"));								    $this->cursor->consultExecute($this->sql->setSentence("30039",$this->request->getVar("COMPANY"),'1','1'));							        while($this->cursor->next($this->cursor->get()))									      $this->_var->increment("CNT_COLLABORATOR");								    }//End if								 if($this->_var->get("COLLABORATOR")){								    $this->_var->set("IMG","b_sbrowse.png");								    $this->_var->set("TITLE",$this->_var->format($this->text->setLabel("MSG_EVALU_ARGUM"),"Colaborador"));									}//End if								 }//End else 						  $this->_var->get("COORDINATOR")?						  $this->cursor->consultExecute($this->sql->setSentence("30036",$this->request->getVar("COMPANY"),$this->request->getVar("COMPANY"),$this->request->getVar("USER"),$this->request->getVar("USER"))):						  $this->cursor->consultExecute($this->sql->setSentence("30032",$this->request->getVar("COMPANY"),$this->request->getVar("COMPANY"),$this->request->getVar("USER")));;								 						  $this->_var->set("ID",1);						  while($this->cursor->next($this->cursor->get())):						        if($this->_var->get("COORDINATOR")&&$this->cursor->getParameter("usucoordinador")==$this->request->getVar("USER"))									if($this->_var->get("CNT_COLLABORATOR")!=$this->_var->get("G_COLLA")){									   $this->_var->set("IMG","b_tblanalyse.png");									   $this->_var->set("TITLE",$this->_var->format($this->text->setLabel("MSG_EVALU_ARGUM"),"Coordinador"));									   }//End if								$this->text->setBuffer('<tr align="center" style="cursor:pointer;" onClick="ClaimComplaint.addressingBring(\''.$this->request->getVar("COMPANY").'\',\''.$this->request->getVar("TYPE").'\',\''.$this->cursor->getParameter("autoid").'\',\'argument\')">													    <td>'.$this->_var->get("ID").'</td>														<td>'.$this->cursor->getParameter("numacta").'</td>													    <td>'.$this->cursor->getParameter("autoid").'</td>													    <td>'.$this->cursor->getParameter("fechasolicitud").'</td>														<td>'.$this->cursor->getParameter("solicita").'</td>														<td>'.$this->cursor->getParameter("asunto").'</td>														<td>'.$this->cursor->getParameter("fechaaprobacionrechazo").'</td>														<td>'.$this->cursor->getParameter("estado").'');														$this->cursor->getParameter("estado")=="Aprobada"?														$this->text->setBuffer(' <img src="/Imgs/'.$this->_var->get("IMG").'" border="0" title="'.$this->_var->get("TITLE").'" />'):null;;														$this->text->setBuffer('</td>														</tr>');//;														$this->_var->increment("ID");						        endwhile;					     $this->cursor->freeResult();				         $this->text->setBuffer('</tbody></table></div>');   					   }//End addressing method		        private function addressingBring(){					   $this->cursor->consultExecute($this->sql->setSentence("30025",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE"),$this->request->getVar("IDENTITY")));					   while($this->cursor->next($this->cursor->get()))							 $this->text->setBuffer($this->cursor->getParameter("numacta").'|'.													$this->cursor->getParameter("cod_qrs").'|'.													$this->cursor->getParameter("autoid").'|'.													$this->cursor->getParameter("fechasolicitud").'|'.													$this->cursor->getParameter("solicita").'|'.													$this->cursor->getParameter("direccion").'|'.													$this->cursor->getParameter("telefono").'|'.													$this->cursor->getParameter("email").'|'.													$this->cursor->getParameter("familiar").'|'.													$this->cursor->getParameter("clasificacion").'|'.													$this->cursor->getParameter("otros").'|'.													$this->cursor->getParameter("canal").'|'.													$this->cursor->getParameter("proceso").'|'.													$this->cursor->getParameter("asunto").'|'.													$this->cursor->getParameter("queja").'|'.													$this->cursor->getParameter("apruebarechaza").'|'.													$this->cursor->getParameter("usucoordinador").'|');					     if($this->request->getVar("SELECTED")=="proposed"){						    $this->cursor->consultExecute($this->sql->setSentence("30000"));                            while($this->cursor->next($this->cursor->get()))							      $this->_var->VUser[$this->cursor->getParameter("usuario")]=array($this->cursor->getParameter("usuario"),$this->cursor->getParameter("nombre"));								    $this->cursor->consultExecute($this->sql->setSentence("30043",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE"),$this->request->getVar("IDENTITY")));					        while($this->cursor->next($this->cursor->get()))							      $this->text->setBuffer("<br>".$this->_var->VUser[$this->cursor->getParameter("colaborador")][1].'|'.													     "<br>".$this->cursor->getParameter("fechaargumento").'|'.													     $this->cursor->getParameter("argumento").'|<script>Utility.easyJQ("specialAction","draggable");</script>								 <div id="specialAction" '.$this->data->getParameter("GUI_TOP_RIGHT").'>									<table '.$this->data->getParameter("GUI").' class="ui-widget-content  ui-corner-all">									    <tr align="center">												<td class="ui-widget-header ui-corner-all" colspan="2" height="40px" style="cursor:move;">'.$this->_var->format($this->text->setLabel("MSG_ADD"),"Nueva Actividad o Acci&oacute;n").'</td>       										</tr><tr>										  <td>									<form id="saveActivity">										<table class="ui-state-highlight ui-corner-all">										<tr>									   <td width="100%" class="ui-state-default" align="right">* Actividad:</td>									   <td><textarea class="required" id="Actividad" name="Actividad" '.$this->data->getParameter("GUI_CONTROL").' cols="45" rows="2"></textarea></td> 									</tr>									<tr>									   <td class="ui-state-default" align="right">* Fecha Cumplimiento:</td>									   <td><input type="Text" class="required" id="FechaCumplimiento" name="FechaCumplimiento" '.$this->data->getParameter("GUI_CONTROL").' size="10" readonly><script>$(function(){Utility.date("FechaCumplimiento");});</script></td>									</tr>										<tr>									   <td width="100%" class="ui-state-default" align="right">* Colaborador:</td>									   <td><select class="required" id="Responsable" name="Responsable" '.$this->data->getParameter("GUI_CONTROL").'>											 <option value="">'.$this->text->setLabel("LBL_SELECT").'</option>');							  $this->cursor->consultExecute($this->sql->setSentence("30000"));														while($this->cursor->next($this->cursor->get()))												  $this->text->setBuffer('<option value="'.$this->cursor->getParameter("usuario").'">'.$this->cursor->getParameter("nombre").'</option>');		 											 $this->text->setBuffer('</select>									   </td> 									</tr>									<tr class="ui-state-default" align="center">											   <td colspan="6"><a href="#" id="ClaimComplaintSaveActivity" class="ui-button ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false" onClick="ClaimComplaint.saveActivity()"><span class="ui-button-text" >Guardar</span></a></td>									</tr>																											<tr><td colspan="6">																		<table align="center" class="ui-state-highlight">								 <tr align="center"><td class="ui-state-default">');							  //$this->cursor->consultExecute($this->sql->setSentence("30021",$this->request->getVar("CODE")));							  //$this->cursor->next($this->cursor->get());							  $this->text->setBuffer('Id '.''/*$this->cursor->getParameter("tipo")*/.'</td><td class="ui-state-default">Actividad</td>							  <td class="ui-state-default">Fecha Cumplimiento</td><td class="ui-state-default">Responsable</td>							  <td class="ui-state-default">Estado</td><td class="ui-state-default">-</td></tr>');                              							  $this->cursor->consultExecute($this->sql->setSentence("30044",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE"),$this->request->getVar("IDENTITY")));							  while($this->cursor->next($this->cursor->get()))							        $this->text->setBuffer('<tr align="center"><td>'.$this->cursor->getParameter("idsolicitud").'</td>																     <td>'.$this->cursor->getParameter("actividad").'</td>																	 <td>'.$this->cursor->getParameter("fechacumplimiento").'</td>																	 <td>'.$this->cursor->getParameter("responsable").'</td>																	 <td>'.$this->cursor->getParameter("estado").'</td>																	 <td><img style="scroll: 10px center;" src="../Imgs/b_drop.png" title="" alt="" onclick="ClaimComplaint.deleteActivity()"/>																		 <input type="hidden" id="application" name="application" value="'.$this->cursor->getParameter("idsolicitud").'">																		 <input type="hidden" id="codeAct" name="codeAct" value="'.$this->cursor->getParameter("cod_qrs").'">																		 <input type="hidden" id="identityAct" name="identityAct" value="'.$this->cursor->getParameter("idactividad").'"></td>																</tr>');							  $this->text->setBuffer('</table>									</td></tr>																	  </table>								  </form></td></tr>								  								  								  </table></div>');						    }//End if					     $this->cursor->freeResult();                       }//End addressingBring					         private function approvedRejected(){	                   !$this->request->getVar("TYPE")?$this->text->setBuffer('<script>Text.hide("contenetor");</script>'):$this->text->setBuffer('<script>Text.show("contenetor");</script>');;					   switch($this->request->getVar("TYPE")){							  case "":$this->text->setBuffer('||');break;							  case "Rechazada":							  $this->text->setBuffer('* Motivo de Rechazo:|<textarea class="required" id="MotivoRechazo" name="MotivoRechazo" '.$this->data->getParameter("GUI_CONTROL").' cols="45" rows="2"></textarea>');							  break;							  case "Aprobada":							  $this->cursor->consultExecute($this->sql->setSentence("30026",$this->request->getVar("COMPANY")));                              $this->text->setBuffer('* Direccionar a:|<select class="required" id="Coordinador" name="Coordinador" '.$this->data->getParameter("GUI_CONTROL").'>							                                           <option value="">'.$this->text->setLabel("LBL_SELECT").'</option>');							  while($this->cursor->next($this->cursor->get()))							        $this->text->setBuffer('<option value="'.$this->cursor->getParameter("coordinador").'">'.$this->cursor->getParameter("nombre").'</option>');		 							  $this->text->setBuffer('</select>|<script>Utility.easyJQ("specialCollab","draggable");</script>');								 $this->request->getVar("SELECTED")!="proposed"?$this->text->setBuffer('<div id="specialCollab" '.$this->data->getParameter("GUI_TOP_RIGHT").'>'):								 $this->text->setBuffer('<div id="specialCollab" '.$this->data->getParameter("GUI_BUTTOM_RIGHT").'>');;									$this->text->setBuffer('<table '.$this->data->getParameter("GUI").' class="ui-widget-content  ui-corner-all">									<tr align="center">												<td class="ui-widget-header ui-corner-all" colspan="2" height="40px" style="cursor:move;">');$this->request->getVar("SELECTED")!="proposed"?$this->text->setBuffer(''.$this->_var->format($this->text->setLabel("MSG_ADD"),"Colaborador")):$this->text->setBuffer(''.$this->_var->format($this->text->setLabel("MSG_LIST"),"Colaboradores"));;$this->text->setBuffer('</td>       										</tr>									<tr>										  <td>									<form id="savePartner">										<table class="ui-state-highlight ui-corner-all">');									if($this->request->getVar("SELECTED")!="proposed"){									$this->text->setBuffer('<tr>									   <td width="100%" class="ui-state-default" align="right">* Colaborador:</td>									   <td><select class="required" id="Colaborador" name="Colaborador" '.$this->data->getParameter("GUI_CONTROL").'>											 <option value="">'.$this->text->setLabel("LBL_SELECT").'</option>');							  $this->cursor->consultExecute($this->sql->setSentence("30030",$this->request->getVar("COMPANY"),$this->request->getVar("CODE"),$this->request->getVar("IDENTITY")));														while($this->cursor->next($this->cursor->get()))												  $this->text->setBuffer('<option value="'.$this->cursor->getParameter("usuario").'">'.$this->cursor->getParameter("nombre").'</option>');		 											 $this->text->setBuffer('</select>									   </td> 									</tr>									<tr class="ui-state-default" align="center">											   <td colspan="6"><a href="#" id="ClaimComplaintSavePartner" class="ui-button ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false" onClick="ClaimComplaint.savePartner()"><span class="ui-button-text" >Guardar</span></a></td>									</tr>																											<tr>');}//End if									$this->text->setBuffer('<td colspan="6">																											<table align="center" class="ui-state-highlight">								 <tr align="center"><td class="ui-state-default">');							  $this->cursor->consultExecute($this->sql->setSentence("30021",$this->request->getVar("CODE")));							  $this->cursor->next($this->cursor->get());							  $this->text->setBuffer('Id '.''/*$this->cursor->getParameter("tipo")*/.'</td><td class="ui-state-default">Colaborador</td>');$this->request->getVar("SELECTED")!="proposed"?$this->text->setBuffer('<td class="ui-state-default">-</td>'):null;;$this->text->setBuffer('</tr>');                              							  $this->cursor->consultExecute($this->sql->setSentence("30028"));							  while($this->cursor->next($this->cursor->get()))							        $this->VUser[$this->cursor->getParameter("usuario")]=array($this->cursor->getParameter("usuario"),$this->cursor->getParameter("nombre"));							 							  $this->cursor->consultExecute($this->sql->setSentence("30027",$this->request->getVar("COMPANY"),$this->request->getVar("CODE"),$this->request->getVar("IDENTITY")));							  while($this->cursor->next($this->cursor->get()))							        $this->VCollaborator[$this->cursor->getParameter("colaborador")]=array($this->cursor->getParameter("cod_qrs"),$this->cursor->getParameter("idsolicitud"),$this->cursor->getParameter("colaborador"));								  							  foreach($this->VCollaborator as $this->IdCollab)	{										 $this->text->setBuffer('<tr align="center"><td>'.$this->IdCollab[1].'</td>																     <td>'.$this->VUser[$this->IdCollab[2]][1].'</td>');                                                                     $this->request->getVar("SELECTED")!="proposed"?																	 																	 $this->text->setBuffer('<td><img style="scroll: 10px center;" src="../Imgs/b_drop.png" title="" alt="" onclick="ClaimComplaint.deleteCollab()"/>																	     <input type="hidden" id="collab" name="collab" value="'.$this->VUser[$this->IdCollab[2]][0].'">																		 <input type="hidden" id="code" name="code" value="'.$this->request->getVar("CODE").'">																		 <input type="hidden" id="identity" name="identity" value="'.$this->request->getVar("IDENTITY").'"></td>'):null;;        	               																 $this->text->setBuffer('</tr>');										}//End foreach								  $this->text->setBuffer('</table>									</td></tr>																	  </table>								  </form></td></tr>								  								  								  </table></div>');							  $this->cursor->freeResult();							  break;					   }//End switch					   }//End approvedRejected method	  private function deleteCollab(){					   $this->cursor->consultExecute($this->sql->setSentence("30040",																			 $this->request->getVar("COMPANY"),																			 $this->request->getVar("CODE"),																			 $this->request->getVar("IDENTITY"),																			 $this->request->getVar("COLLAB")));					   if($this->cursor->get())						  $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DELETE").'");</script>');	 					   $this->cursor->freeResult();					   }//End deleteCollab method					   	  private function deleteActivity(){					   $this->cursor->consultExecute($this->sql->setSentence("30048",																			 $this->request->getVar("COMPANY"),																			 $this->request->getVar("CODE_ACT"),																			 $this->request->getVar("APPLICATION"),																			 $this->request->getVar("IDENTITY_ACT")));					   if($this->cursor->get())						  $this->text->setBuffer('<script>ClaimComplaint.addressingBring(\''.$this->request->getVar("COMPANY").'\',\''.$this->request->getVar("CODE").'\',\''.$this->request->getVar("IDENTITY").'\',\'proposed\')</script>|<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DELETE").'");</script>');	 					   $this->cursor->freeResult();					   }//End deleteActivity method				   					   	  private function savePartner(){					   $this->cursor->consultExecute($this->sql->setSentence("30031",$this->request->getVar("COMPANY"),																					 $this->request->getVar("CODE"),																					 $this->request->getVar("IDENTITY"),																					 $this->request->getVar("COLLABORATOR")));					   if($this->cursor->get())						  $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");</script>');	                       $this->cursor->freeResult();						  					   }//End savePartner method					   	  private function saveActivity(){					   $this->cursor->consultExecute($this->sql->setSentence("30045",$this->request->getVar("COMPANY"),																					 $this->request->getVar("CODE"),																					 $this->request->getVar("IDENTITY"),																					 $this->request->getVar("ACTIVITY"),																					 $this->request->getVar("COMPLIANCE_DATE"),																					 $this->request->getVar("RESPONSIBLE"),																					 $this->data->setDate("Y","m","d")." ".$this->text->replace($this->data->setDate("h","i","s"),"-",":"),																					 $this->request->getVar("USER")));					   if($this->cursor->get())						  $this->text->setBuffer('<script>ClaimComplaint.addressingBring(\''.$this->request->getVar("COMPANY").'\',\''.$this->request->getVar("CODE").'\',\''.$this->request->getVar("IDENTITY").'\',\'proposed\')</script>|<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");</script>');	                       $this->cursor->freeResult();						  					   }//End saveActivity method				   	  	  private function saveSolution(){					   $this->cursor->consultExecute($this->sql->setSentence("30046",$this->request->getVar("COMPANY"),																					 $this->request->getVar("CODE"),																					 $this->request->getVar("IDENTITY")));					   $this->cursor->consultExecute($this->sql->setSentence("30047",$this->request->getVar("COMPANY"),																					 $this->request->getVar("NO_ACT"),																					 $this->request->getVar("CODE"),																					 $this->request->getVar("IDENTITY")));					   if($this->cursor->get())						  $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");</script>');	                       $this->cursor->freeResult();						  					   }//End saveSolution method	        private function saveAddressing(){					   $this->cursor->consultExecute($this->sql->setSentence("30029",$this->request->getVar("APROVED_REJECTED"),																					 $this->request->getVar("APROVED_REJECTED"),																					 $this->request->getVar("CAUSE_REJECTION"),																					 $this->request->getVar("USER"),																					 $this->data->setDate("Y","m","d")." ".$this->text->replace($this->data->setDate("h","i","s"),"-",":"),																					 $this->request->getVar("COORDINATOR"),																					 $this->request->getVar("COMPANY"),																					 $this->request->getVar("NO_ACT"),																					 $this->request->getVar("CODE"),																					 $this->request->getVar("IDENTITY")));					   if($this->cursor->get())					   $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");</script>');					   $this->cursor->freeResult();						   }//End saveAddressing method		            private function saveArgument(){					   $this->cursor->consultExecute($this->sql->setSentence("30033",$this->request->getVar("ARGUMENT"),																					 $this->data->setDate("Y","m","d"),																					 $this->text->replace($this->data->setDate("h","i","s"),"-",":"),																					 $this->request->getVar("COMPANY"),																					 $this->request->getVar("CODE"),																					 $this->request->getVar("IDENTITY"),																					 $this->request->getVar("USER")));					   $this->cursor->consultExecute($this->sql->setSentence("30034","Argumentado",																					 $this->request->getVar("COMPANY"),																					 $this->request->getVar("NO_ACT"),																					 $this->request->getVar("CODE"),																					 $this->request->getVar("IDENTITY")));					   if($this->cursor->get())					   $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");</script>');					   $this->cursor->freeResult();						   }//End saveArgument method			        //********************************************************************************************************************* 		        //OPEN_MAILBOX*****************************************************************************************************	  	  private function saveInitialization(){					   $this->cursor->consultExecute($this->sql->setSentence("30022",$this->request->getVar("COMPANY")));					   $this->cursor->next($this->cursor->get());					   if($this->cursor->getParameter("cnt_numact")>0)					     $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_NOT_HAVE_BEEN_RECORDED").'");</script>');						 else{	 					   $this->cursor->consultExecute($this->sql->setSentence("30009",$this->request->getVar("COMPANY")));					   while($this->cursor->next($this->cursor->get()))							 $this->VApprovers[$this->cursor->getParameter("aprobador")]=$this->cursor->getParameter("aprobador");						 					   $this->cursor->consultExecute($this->sql->setSentence("30004"));					   while($this->cursor->next($this->cursor->get())){					         $this->VNameTypeCC[]=$this->cursor->getParameter("tipo");					         $this->VTypeCC[]=$this->cursor->getParameter("codigo");							 if($this->cursor->getParameter("codigo")==1)							    $this->VAmountTypeCC[]=$this->request->getVar("CLAIMS");							 if($this->cursor->getParameter("codigo")==2)							    $this->VAmountTypeCC[]=$this->request->getVar("GREETINGS");							 if($this->cursor->getParameter("codigo")==3)							    $this->VAmountTypeCC[]=$this->request->getVar("SUGGESTIONS");							 }//End while											   if(!$this->request->getVar("NO_ACT")){					   $this->cursor->consultExecute($this->sql->setSentence("30003",$this->request->getVar("COMPANY")));					   if($this->cursor->next($this->cursor->get()))					      $this->_var->set("NO_ACT",$this->cursor->getParameter("numacta")+1);						  else{						      $this->cursor->consultExecute($this->sql->setSentence("30008",$this->request->getVar("COMPANY")));							  if($this->cursor->next($this->cursor->get()))							     $this->_var->set("NO_ACT",$this->cursor->getParameter("numinicialacta"));						      }//End else						  $this->text->setBuffer('<script>Request.setValue("NoActa","'.$this->_var->get("NO_ACT").'");</script>');					   }else $this->_var->set("NO_ACT",$this->request->getVar("NO_ACT"));					  					   for($this->TC=0;$this->TC<$this->_var->getSize($this->VTypeCC);					       $this->cursor->consultExecute($this->sql->setSentence("30001",																			 $this->request->getVar("COMPANY"),																			 $this->_var->get("NO_ACT"),																			 $this->request->getVar("OPENING_DATE"),																			 $this->request->getVar("HOURS"),																			 $this->request->getVar("MINUTES"),																			 $this->data->setDate("Y","m","d"),																			 $this->text->replace($this->data->setDate("h","i","s"),"-",":"),																			 $this->request->getVar("USER"),																			 $this->request->getVar("OPEN_MAILBOX"),																			 $this->VTypeCC[$this->TC],																			 $this->VAmountTypeCC[$this->TC])),						   $this->TC++);					   														 					   $this->openingAct="En la ciudad de Manizales, siendo las ".$this->request->getVar("HOURS").":".$this->request->getVar("MINUTES")." horas del ".$this->request->getVar("OPENING_DATE")."";													 					   !$this->VAmountTypeCC[0]?$this->_var->set("AMOUNA","0"):null;;!$this->VAmountTypeCC[1]?$this->_var->set("AMOUNE","0"):null;;!$this->VAmountTypeCC[2]?$this->_var->set("AMOUNI","0"):null;;					   $this->openingAct=$this->openingAct." se dio apertura al buzon de Quejas y Reclamos, en el cual \n\rse encontraron ".$this->VAmountTypeCC[0].$this->_var->get("AMOUNA")." ".$this->VNameTypeCC[0].", ".$this->VAmountTypeCC[1].$this->_var->get("AMOUNE")." ".$this->VNameTypeCC[1].", ".$this->VAmountTypeCC[2].$this->_var->get("AMOUNI")." ".$this->VNameTypeCC[2].", que se registraron en el Sistema OH Mentor.  ";					   $this->cursor->consultExecute($this->sql->setSentence("30052",$this->request->getVar("USER")));					   $this->cursor->next($this->cursor->get());					   $this->openingAct=$this->openingAct."\n\r\n\r\n\r\n\r".$this->cursor->getParameter("nombre")."";					   if(!$this->request->getVar("NO_ACT"))					   $this->cursor->consultExecute($this->sql->setSentence("30015",																			 $this->request->getVar("COMPANY"),																			 $this->_var->get("NO_ACT"),																			 $this->openingAct));					   $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");</script>');					   }//End else					   }//End saveInitialization method	  //********************************************************************************************************************* 	  //REGISTER_REQUEST*****************************************************************************************************	  	  private function saveOpenMailbox(){	                   $this->cursor->consultExecute($this->sql->setSentence("30049",$this->request->getVar("COMPANY")));					   $this->cursor->next($this->cursor->get());					   $this->_var->set("CNT_REG",$this->cursor->getParameter("cnt_reg"));					   if($this->cursor->getParameter("cnt_reg")>0){;						  $this->cursor->consultExecute($this->sql->setSentence("30050",$this->request->getVar("COMPANY"),$this->cursor->getParameter("cnt_reg"),$this->cursor->getParameter("numacta"),$this->cursor->getParameter("cod_qrs")));					      $this->cursor->next($this->cursor->get());						  if($this->cursor->getParameter("num_qrs")==$this->_var->get("CNT_REG"))					      $this->text->setBuffer('<script>Utility.acceptBox("'.$this->_var->format($this->text->setLabel("MSG_MUST"),"una apertura de buz&oacute;n").'");</script>');						  else{						      							  							  $this->cursor->consultExecute($this->sql->setSentence("30009",$this->request->getVar("COMPANY")));					   while($this->cursor->next($this->cursor->get()))							 $this->VApprovers[$this->cursor->getParameter("aprobador")]=$this->cursor->getParameter("aprobador");						 					   $this->cursor->consultExecute($this->sql->setSentence("30004"));					   while($this->cursor->next($this->cursor->get()))					         $this->VTypeCC[$this->cursor->getParameter("codigo")]=$this->cursor->getParameter("tipo");					   					   $this->cursor->consultExecute($this->sql->setSentence("30005",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE")));					   $this->cursor->next($this->cursor->get());					   $this->_var->set("AUTO_ID",$this->cursor->getParameter("autoid")+1);					   					   					   $this->cursor->consultExecute($this->sql->setSentence("30023",$this->request->getVar("COMPANY")));					   $this->cursor->next($this->cursor->get());					   $this->_var->set("NO_ACT",$this->cursor->getParameter("numacta"));					   					   $this->cursor->consultExecute($this->sql->setSentence("30006",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE"),$this->_var->get("AUTO_ID")));					   $this->cursor->next($this->cursor->get());					   if($this->cursor->getParameter("AutoId")==0){					      if(!$this->request->getVar("CLASSIFICATION")) $this->_var->set("CLASSIFICATION","NULL"); else $this->_var->set("CLASSIFICATION",$this->request->getVar("CLASSIFICATION")); 						  $this->cursor->consultExecute($this->sql->setSentence("30007",																				$this->request->getVar("COMPANY"),																				$this->_var->get("NO_ACT"),																				$this->request->getVar("TYPE"),																				$this->_var->get("AUTO_ID"),																				$this->request->getVar("CLAIM_DATE"),																				$this->data->setDate("Y","m","d"),																				$this->text->replace($this->data->setDate("h","i","s"),"-",":"),																				$this->request->getVar("USER"),																				$this->request->getVar("WHO_MAKE_REQ"),																				$this->request->getVar("ADDRESS"),																				$this->request->getVar("PHONE"),																				$this->request->getVar("EMAIL"),																				$this->request->getVar("FAMILY_OR_TH"),																				$this->_var->get("CLASSIFICATION"),																				$this->request->getVar("OTHER"),																				$this->request->getVar("COMMUNICATION_CHANNEL"),																				$this->request->getVar("PROCESS"),																				$this->request->getVar("SUBJECT"),																				$this->request->getVar("REGISTER")));					      if($this->cursor->get()){						     if($this->VApprovers)																				    foreach($this->VApprovers as $this->Approv){																//--Email										$this->cursor->consultExecute($this->sql->setSentence("30010",$this->request->getVar("COMPANY")));										$this->cursor->next($this->cursor->get());										   $this->_var->set("SUBJECT","Nueva Solicitud de Aprobacion de ".$this->VTypeCC[$this->request->getVar("TYPE")]);										   $this->_var->set("MESSAGE","Se acaba de Registrar una nueva Solicitud de ".$this->VTypeCC[$this->request->getVar("TYPE")]." con Asunto:<br><strong>".$this->request->getVar("SUBJECT")."</strong>.<br>Esperamos su Aprobacion o Rechazo.<br>Para realizar este proceso se debe dirigir al modulo de Quejas y Reclamos y buscar el item Direccionamiento.<br><br>Nota: Este mensaje se envio automaticamente por el Sistema.");										   $this->cursor->consultExecute($this->sql->setSentence("30011",																								 $this->request->getVar("COMPANY"),																								 ($this->cursor->getParameter("id")+1),																								 $this->_var->get("SUBJECT"),																								 $this->request->getVar("USER"),																								 $this->data->setDate("Y","m","d"),																								 $this->text->replace($this->data->setDate("h","i","s"),"-",":"),																								 $this->Approv,																								 $this->_var->get("MESSAGE")));																 								}//End foreach							    $this->cursor->consultExecute($this->sql->setSentence("30012",																				   $this->request->getVar("COMPANY"),																				   $this->_var->get("NO_ACT"),																				   $this->request->getVar("TYPE")));								 $this->_var->set("NO_TOTAL_CC",$this->cursor->getParameter("num_qrs"));							 $this->cursor->consultExecute($this->sql->setSentence("30013",																				   $this->request->getVar("COMPANY"),																				   $this->_var->get("NO_ACT"),																				   $this->request->getVar("TYPE")));								 $this->_var->set("COUNTING_RECORDS",$this->cursor->getParameter("COUNTING_RECORDS"));							 if($this->_var->get("NO_TOTAL_CC")==$this->_var->get("COUNTING_RECORDS"))							    $this->cursor->consultExecute($this->sql->setSentence("30014",								                                                     ($this->_var->get("CNT_REG")+1),																				      $this->request->getVar("COMPANY"),																				      $this->_var->get("NO_ACT"),																					  $this->request->getVar("TYPE")));						    $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");Request.setValue("code","'.$this->request->getVar("TYPE").'",false);Request.setValue("identity","'.$this->_var->get("AUTO_ID").'",false);</script>');							}//End if													  }//End if							  							  							  }    						  }//End if					   else{					   $this->cursor->consultExecute($this->sql->setSentence("30009",$this->request->getVar("COMPANY")));					   while($this->cursor->next($this->cursor->get()))							 $this->VApprovers[$this->cursor->getParameter("aprobador")]=$this->cursor->getParameter("aprobador");						 					   $this->cursor->consultExecute($this->sql->setSentence("30004"));					   while($this->cursor->next($this->cursor->get()))					         $this->VTypeCC[$this->cursor->getParameter("codigo")]=$this->cursor->getParameter("tipo");					   					   $this->cursor->consultExecute($this->sql->setSentence("30005",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE")));					   $this->cursor->next($this->cursor->get());					   $this->_var->set("AUTO_ID",$this->cursor->getParameter("autoid")+1);					   					   					   $this->cursor->consultExecute($this->sql->setSentence("30023",$this->request->getVar("COMPANY")));					   $this->cursor->next($this->cursor->get());					   $this->_var->set("NO_ACT",$this->cursor->getParameter("numacta"));					   					   $this->cursor->consultExecute($this->sql->setSentence("30006",$this->request->getVar("COMPANY"),$this->request->getVar("TYPE"),$this->_var->get("AUTO_ID")));					   $this->cursor->next($this->cursor->get());					   if($this->cursor->getParameter("AutoId")==0){					      if(!$this->request->getVar("CLASSIFICATION")) $this->_var->set("CLASSIFICATION","NULL"); else $this->_var->set("CLASSIFICATION",$this->request->getVar("CLASSIFICATION")); 						  $this->cursor->consultExecute($this->sql->setSentence("30007",																				$this->request->getVar("COMPANY"),																				$this->_var->get("NO_ACT"),																				$this->request->getVar("TYPE"),																				$this->_var->get("AUTO_ID"),																				$this->request->getVar("CLAIM_DATE"),																				$this->data->setDate("Y","m","d"),																				$this->text->replace($this->data->setDate("h","i","s"),"-",":"),																				$this->request->getVar("USER"),																				$this->request->getVar("WHO_MAKE_REQ"),																				$this->request->getVar("ADDRESS"),																				$this->request->getVar("PHONE"),																				$this->request->getVar("EMAIL"),																				$this->request->getVar("FAMILY_OR_TH"),																				$this->_var->get("CLASSIFICATION"),																				$this->request->getVar("OTHER"),																				$this->request->getVar("COMMUNICATION_CHANNEL"),																				$this->request->getVar("PROCESS"),																				$this->request->getVar("SUBJECT"),																				$this->request->getVar("REGISTER")));					      if($this->cursor->get()){						     if($this->VApprovers)																				    foreach($this->VApprovers as $this->Approv){																//--Email										$this->cursor->consultExecute($this->sql->setSentence("30010",$this->request->getVar("COMPANY")));										$this->cursor->next($this->cursor->get());										   $this->_var->set("SUBJECT","Nueva Solicitud de Aprobacion de ".$this->VTypeCC[$this->request->getVar("TYPE")]);										   $this->_var->set("MESSAGE","Se acaba de Registrar una nueva Solicitud de ".$this->VTypeCC[$this->request->getVar("TYPE")]." con Asunto:<br><strong>".$this->request->getVar("SUBJECT")."</strong>.<br>Esperamos su Aprobacion o Rechazo.<br>Para realizar este proceso se debe dirigir al modulo de Quejas y Reclamos y buscar el item Direccionamiento.<br><br>Nota: Este mensaje se envio automaticamente por el Sistema.");										   $this->cursor->consultExecute($this->sql->setSentence("30011",																								 $this->request->getVar("COMPANY"),																								 ($this->cursor->getParameter("id")+1),																								 $this->_var->get("SUBJECT"),																								 $this->request->getVar("USER"),																								 $this->data->setDate("Y","m","d"),																								 $this->text->replace($this->data->setDate("h","i","s"),"-",":"),																								 $this->Approv,																								 $this->_var->get("MESSAGE")));																 								}//End foreach							    $this->cursor->consultExecute($this->sql->setSentence("30012",																				   $this->request->getVar("COMPANY"),																				   $this->_var->get("NO_ACT"),																				   $this->request->getVar("TYPE")));								 $this->_var->set("NO_TOTAL_CC",$this->cursor->getParameter("num_qrs"));							 $this->cursor->consultExecute($this->sql->setSentence("30013",																				   $this->request->getVar("COMPANY"),																				   $this->_var->get("NO_ACT"),																				   $this->request->getVar("TYPE")));								 $this->_var->set("COUNTING_RECORDS",$this->cursor->getParameter("COUNTING_RECORDS"));							 if($this->_var->get("NO_TOTAL_CC")==$this->_var->get("COUNTING_RECORDS"))							    $this->cursor->consultExecute($this->sql->setSentence("30014",								                                                     ($this->_var->get("CNT_REG")+1),																				      $this->request->getVar("COMPANY"),																				      $this->_var->get("NO_ACT"),																					  $this->request->getVar("TYPE")));						    $this->text->setBuffer('<script>Utility.acceptBox("'.$this->text->setLabel("MSG_DATA_SAVE").'");Request.setValue("code","'.$this->request->getVar("TYPE").'",false);Request.setValue("identity","'.$this->_var->get("AUTO_ID").'",false);</script>');							}//End if													  }//End if						  }//End if					   }//End saveOpenMailbox method      //***********************************************************************************************************}//End ClaimComplaint class ?><?php   $ClaimComplaint=ClaimComplaint::getInstance();$Var->release($ClaimComplaint,$Var);?>                                  